<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="laptop">

	<!-- Laptop List 구하기 -->
	<select id = "list" resultType="mybatis.vo.LaptopVO" parameterType="mybatis.vo.LaptopVO">
		SELECT * FROM laptop l INNER JOIN cpu_Bench c ON (c.cpu_Name LIKE '%'||l.cpu_Name)
		
		<choose>
			<!-- gpu_Point에 들어오는 값이 있을 때 -->
			<when test="gpu_Point != 0">
				INNER JOIN gpu_Bench g ON (g.gpu_Name LIKE '%'||l.gpu_Name) WHERE gpu_Point <![CDATA[>=]]> #{gpu_Point} AND
			</when>
			<!-- gpu_Point에 들어오는 값이 없을 때 -->
			<when test="gpu_Point == 0">
				WHERE
			</when>
		</choose>
		
		cpu_Point <![CDATA[>=]]> #{cpu_Point} AND 
		
		<!-- OS -->
		<if test="laptop_OS != null">
			<trim suffix="AND">
				<choose>
					<when test="laptop_OS == '윈도우10'">
						(laptop_OS LIKE #{laptop_OS}||'%' OR laptop_OS = '미포함')
					</when>
					<when test="laptop_OS == 'mac'">
						laptop_OS LIKE #{laptop_OS}||'%'
					</when>
					<when test="laptop_OS == '리눅스'">
						laptop_OS = #{laptop_OS}
					</when>  
				</choose>
			</trim>
		</if>
		
		<!-- 모니터 사이즈 -->
		<if test="laptop_MonitorSize != null">
			<trim suffix="AND">
				<choose>
					<when test="laptop_MonitorSize == '0'">
						laptop_MonitorSize <![CDATA[<]]> 13 
					</when>
					<when test="laptop_MonitorSize == '1'">
						(laptop_MonitorSize BETWEEN 13 AND 15)
					</when>
					<when test="laptop_MonitorSize == '2'">
						laptop_MonitorSize <![CDATA[>]]> 15
					</when>
				</choose>
			</trim>
		</if> 
		
		<!-- laptop 무게 -->
		<if test="laptop_Weight != null">
			<trim suffix="AND">
				<choose>
					<when test="laptop_Weight == 0.0">
						laptop_Weight <![CDATA[<]]> 1.5
					</when>
					<when test="laptop_Weight == 1.0">
						(laptop_Weight BETWEEN 1.5 and 1.9)
					</when>
					<when test="laptop_Weight == 2.0">
						laptop_Weight <![CDATA[>]]> 1.9
					</when>
				</choose>
			</trim>
		</if>
		
		<!-- laptop의 가격 -->
		<if test="laptop_Price != null">
			<choose>
				<when test="laptop_Price == '0'">
					laptop_Price <![CDATA[<]]> 500000
				</when>
				<when test="laptop_Price == '1'">
					laptop_Price <![CDATA[<]]> 800000
				</when>
				<when test="laptop_Price == '2'">
					laptop_Price <![CDATA[<]]> 1100000
				</when>
				<when test="laptop_Price == '3'">
					laptop_Price <![CDATA[>=]]> 1100000
				</when>
			</choose>
		</if>
		
		ORDER BY laptop_Price		
		
	</select>
	
	<!-- 프로그램  cpu, gpu점수 구하기 -->
	<select id="program" resultType="mybatis.vo.Program_BenchVO" parameterType="java.util.Map">
		SELECT * FROM program_Bench WHERE program_Name = #{program_Name}
	</select>
	
	<!-- favorite List 구하기 -->
	<select id="f_list" resultType="mybatis.vo.LaptopVO" parameterType="java.util.Map">
		SELECT * FROM laptop NATURAL JOIN favorite WHERE f_key = #{f_key}
	</select>
</mapper>